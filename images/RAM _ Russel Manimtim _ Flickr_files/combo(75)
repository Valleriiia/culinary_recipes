YUI.add("hermes-template-group-guidelines_zh-HK",(function(r,e){var p=r.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(r,e,p,t,s){return'<h1>管理您 Flickr 群組的提示</h1><p>群組是 Flickr 社群的核心，為志同道合的 Flickr 成員提供了互動和消磨時光的最佳場所。群組管理員透過確定群組主題及規則，來設立群組的基調，並確保參與者遵守這些規範。以下是一些建議，幫助您維持群組的正常運作。</p><p><strong>管理群組的提示<br /></strong></p><p>如果您是群組的管理員，以下建議可以幫助您打造一個繁榮的社群。</p><p><strong>邀請您的朋友</strong>，以及任何您認識且與您有相同興趣的人加入群組。請求其他群組的成員和管理員協助幫忙傳播消息。在您的「關於」頁面的描述區域中分享直接連結，來宣傳您的群組。如果您活躍於其他社交媒體平台，分享您的群組連結並邀請他人加入。</p><p>閱讀更多有關<a href="https://help.flickr.com/en_us/invite-friends-to-your-flickr-group-ry0s27i17">如何邀請人們加入您的 Flickr 群組</a>的資訊</p><p><strong>幫助新成員感到賓至如歸。</strong>利用群組描述來說明基本資訊，例如您的群組主題是什麼。發起一個「歡迎！」的討論串，讓新成員自我介紹，並讓他們了解您的身份以及您可以提供的幫助。</p><p><strong>成為一個積極的參與者。</strong>群組的繁榮來自於每日的討論以及社群其他成員的積極回應。積極參與討論，並鼓勵其他成員也加入討論。參與者可能會需要一些發文內容的想法和指導。</p><p><strong>營造一種社群感。</strong>提問是激發討論的絕佳方式。鼓勵其他成員也這樣做。群組挑戰是一種有趣的方式，可以讓大家積極參與討論。</p><p>閱讀更多關於在 Flickr 群組中<a href="https://help.flickr.com/en_us/post-reply-to-or-delete-discussions-in-flickr-groups-SJe9n2Qok7">發佈、回覆或刪除討論的相關內容。</a></p><p><strong>管理群組的實用提示</strong></p><p><strong>管理，管理，再管理！</strong>成功的群組依靠良好的管理來維持。把您的群組視作花園，經常的照料和關注將幫助您的群組繁榮和成長。確保每個人都遵守您制定的規則，並確認所有新增的照片都符合群組的主題和目的。<br /><br />為了幫助您管理群組，您可以招募其他成員成為管理員。管理員雖然沒有全部的管理權限，但他們能協助您審核提交的內容、監控討論，並移除不遵守規則的成員，幫助您保持群組的和諧運作。</p><p>閱讀更多關於如何<a href="https://help.flickr.com/en_us/promote-someone-to-an-administrator-or-moderator-r15C2QjyX">提升某人成為管理員或版主的資訊</a></p><p> </p><p><strong>移除與封禁</strong>。以下是一些通用指南，幫助管理員決定如何以及何時使用移除和封禁功能。</p><p><strong>移除。</strong>當您將某人從群組中移除後，他們將不再是成員。您移除的成員不會收到被移除的通知，但他們可以隨時選擇重新加入您的群組。</p><p><strong>封禁。</strong>當您將某人從群組中封禁後，他們將無法再次加入（除非管理員或版主解除封禁）。我們建議對那些不斷發送垃圾訊息、行為不端或故意違反群組規則的人進行封禁。</p><ul><li>明智且謹慎地使用這些權限。大多數衝突都可以通過有效的溝通解決。</li><li>如果有人發佈冒犯性或離題的內容，試著向他們發出警告。私下聯絡他們，並提醒他們遵守規則。</li><li>如果此行為持續，考慮將他們從群組中移除。您可以從成員列表的管理員視圖中執行此操作。</li><li>如果該成員重新加入您的群組後，仍然繼續違反群組規則，請考慮將他們從群組中封禁。您可以從成員列表的管理員視圖中執行此操作。</li><li>在做出這些決定時，請根據自己的最佳判斷，並與群組中的其他管理員協商。</li></ul><p>閱讀更多關於<a href="https://help.flickr.com/en_us/remove-someone-from-your-flickr-group-rJtjnXjy7">從 Flickr 群組中移除成員</a>的相關內容</p><p><strong>以管理員身份離職。</strong>如果您覺得自己需要辭去管理員或版主的職務，請務必將決定告知其他管理員，以便他們做好準備。如果您是群組的唯一管理員，請在離開前嘗試找到另一位願意承擔管理員角色的成員，以免群組無人管理。</p><p><strong>群組生活</strong></p><p><strong>咒罵和其他行為。</strong>只要您沒有冒犯、侮辱或違反群組規則，這並不違反我們的社群指南。Flickr 對仇恨言論採取零容忍政策，這些違規行為應該向<a href="https://help.flickr.com/en_us/report-abuse-in-flickr-HkoYnXs1Q">我們的信任與安全團隊報告</a>，以便進一步處理。</p><p><strong>群組安全級別。</strong>如果您的群組包含「中等」或「限制」級別的文章，您必須適當設定群組的安全級別。被標記為「中等」或「限制」的群組將被指定為 18 歲以上使用。此外，僅允許「安全」內容用作個人資料圖片和封面圖片。有關安全級別的更多資訊，請參見以下內容：</p><ul><li><a href="https://www.flickrhelp.com/hc/en-us/articles/20529310987796-The-rules-of-Flickr">Flickr 規則</a></li><li><a href="https://www.flickrhelp.com/hc/en-us/articles/23250290741908-Guide-to-Safety-Levels-for-Nudity-Sexual-Content">裸露及性內容的安全級別指南</a></li></ul><p><strong>應對難以相處的群組成員。</strong>酸民是那些行為粗魯且令人厭惡的人，他們通常會試圖冒犯、驚嚇、騷擾、虐待或以其他方式惹惱他人。處理這類人往往很棘手，但不應讓他們在未經警告、未被移除或封禁的情況下繼續存在。酸民可以摧毀一個社群，這通常是他們的目的。</p><p>酸民靠引起關注為生，因此有時應對他們的最佳方式就是完全忽視他們。</p><p>如果您覺得某人令人厭煩或有冒犯行為，您可以阻止他們與您的個人帳號互動，或者將他們從群組中封禁。如果您改變主意，隨時可以解除封禁或取消封鎖某人。</p><p><em></em></p>\n'},useData:!0}),t={};r.Array.each([],(function(e){var p=r.Template.get("hermes/"+e);p&&(t[e]=p)})),r.Template.register("hermes/group-guidelines_zh-HK",(function(e,s){return(s=s||{}).partials=s.partials?r.merge(t,s.partials):t,p(e,s)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("group-guidelines",(function(e){e.GroupGuidelines={getTemplateForCurrentLang:function(i){const t=new e.TemplateLibraryHelper(i),l=i.lang,n="en-US"===l?"group-guidelines":`group-guidelines_${l}`;return t.getTemplate(n)({})},showModal:function(i){const t=e.mix({langBundles:["groups","common"]},e.Localizable);new e.Views.FluidModal({appContext:i,subview:new e.Views["confirmation-dialog-view"]({appContext:i,title:t.intlMessage({intlName:"groups.GROUP_GUIDELINES"}),htmlMessage:e.GroupGuidelines.getTemplateForCurrentLang(i),showCancelButton:!1,confirmButtonText:t.intlMessage({intlName:"common.DONE"})}),width:860,height:640,hasSubviewConfigRefactor:!0,flexLayout:!0}).show()}}}),"@VERSION@",{requires:["template-lib-helper","localizable","hermes-template-group-guidelines","hermes-template-group-guidelines_de-DE","hermes-template-group-guidelines_es-US","hermes-template-group-guidelines_fr-FR","hermes-template-group-guidelines_id-ID","hermes-template-group-guidelines_it-IT","hermes-template-group-guidelines_ko-KR","hermes-template-group-guidelines_pt-BR","hermes-template-group-guidelines_vi-VN","hermes-template-group-guidelines_zh-HK"],langBundles:["groups","common"]});YUI.add("group-creation-view",(function(t,e){var i=require("hermes-core/flog")(e),o={4:{default:"add-to-stuff.ALREADY_GROUP_WITH_NAME"}},n="0",s="2",r="1",a="2",h="3",l="0",c="1";t.namespace("Views")[this.name]=t.Base.create("group-creation-view",t.Views["stuff-creation-view"],[],{langBundles:this.details.langBundles,initializer:function(t){return this.labelList=[{title:"<span>"+this.intlMessage({intlName:"add-to-stuff.CURATIONS_CREATE_A_NEW_GROUP"})+"</span>",cancelText:this.intlMessage({intlName:"common.CANCEL"}),actionText:this.intlMessage({intlName:"stats.NEXT"})},{title:this.intlMessage({intlName:"add-to-stuff.ABOUT_YOUR_GROUP"}),cancelText:this.intlMessage({intlName:"stats.PREVIOUS"}),actionText:this.intlMessage({intlName:"stats.NEXT"})},{title:this.intlMessage({intlName:"groups.GROUP_SAFETY_LEVEL"}),cancelText:this.intlMessage({intlName:"stats.PREVIOUS"}),actionText:this.intlMessage({intlName:"groups.CREATE_GROUP"})}],this.curationType="group",this.titleError=this.intlMessage({intlName:"add-to-stuff.PLEASE_ENTER_GROUP_NAME"}),this.createError=this.intlMessage({intlName:"add-to-stuff.COULDNT_SAVE_GROUP"}),this.photoId=t.photoId,this.groupOptions={ageRestriction:l,privacy:h,safety:n},this.constructor.superclass.initializer.call(this,t)},loadState:function(){var e=this;return this.photoId?this.appContext.getModel("photo-models",this.photoId).then((function(t){var i=t.getValue("safetyLevel");e.photoModel=t,e.groupOptions.safety=i?i.toString():n})):t.Promise.resolve()},buildContainer:function(){return this.activeStep=0,this.setContainerWithTemplate("group-creation-view",{heading:this.labelList[0].title,cancelText:this.labelList[0].cancelButton,actionText:this.labelList[0].actionButton,lang:this.appContext.lang.replace(/\-/g,"_"),urls:{groupGuidelines:"/groups_guidelines.gne",help:"https://flickrhelp.com/hc/en-us/search?query=groups",age:"https://flickrhelp.com/hc/en-us/articles/4404070473364-Flickr-group-administration-options",termsOfService:"/atos/pro",commGuidelines:"/help/guidelines"},safetyLevel:this.groupOptions.safety}),this},activate:function(){var e=this,i=this.get("container");this.headTitleNode=i.one(".title"),this.actionContainer=i.one(".action-container"),this.cancelButton=i.one(".button-cancel"),this.actionButton=i.one(".button-action"),this.closeButton=i.one(".close-x-button"),this.titleNode=i.one(".group-name"),this.descriptionNode=i.one(".group-description"),this.titleErrorNode=i.one(".error-message.title-error"),this.createErrorNode=i.one(".error-message.create-error"),this.privateGroupInput=i.one("#private-group"),this.ageRadioContainer=i.one(".group-age"),this.privacyRadioContainer=i.one(".group-privacy"),this.privateGroupOptionContainer=i.one(".private-group-option-container"),this.headTitleNode.set("innerHTML",this.labelList[0].title),this.cancelButton.set("text",this.labelList[0].cancelText),this.actionButton.set("text",this.labelList[0].actionText),this.registerEventHandler(this.privacyRadioContainer.on("change",this.handlePrivacyRadioChange.bind(this))),this.registerEventHandler(this.ageRadioContainer.on("change",this.handleAgeRadioChange.bind(this))),this.registerEventHandler(this.cancelButton.on("click",this.handleCancel.bind(this))),this.registerEventHandler(this.actionButton.on("click",this.handleAction.bind(this))),this.registerEventHandler(this.closeButton.on("click",function(){e.fire("readyToClose")}.bind(this))),this.registerEventHandler(this.titleNode.on("keyup",function(){this.titleNode.get("value")&&this.showError(this.titleErrorNode,!1)}.bind(this))),this.registerEventHandler(this.privacyRadioContainer.on("keydown",this.handlePrivacyKeyPress.bind(this))),this.registerEventHandler(this.ageRadioContainer.on("keydown",this.handleAgeKeyPress.bind(this))),this.registerEventHandler(i.one(".group-creation-content-container").delegate("click",(e=>{e.preventDefault(),t.GroupGuidelines.showModal(this.appContext)}),".step-description .guidelines-link")),this.constructor.superclass.activate.call(this,this.params)},handleCancel:function(){this.activeStep>0?this.goToStep(this.activeStep-1):this.params.inlineCreation?(this.fire("cancel"),this.resetView()):this.fire("readyToClose")},handleAction:function(){0===this.activeStep?this.goToStep(this.activeStep+1):1===this.activeStep?this.titleNode.get("value")?this.goToStep(this.activeStep+1):this.showError(this.titleErrorNode,!0,this.titleError):this.titleNode.get("value")?(this.showError(this.createErrorNode,!1),this.createCuration().then(function(t){this.fire("created",{type:this.curationType,curation:t}),this.params.inlineCreation?this.resetView():this.fire("readyToClose")}.bind(this)).catch(function(t){var e=t.code;4===e&&o.hasOwnProperty(e)?(this.goToStep(1),this.showError(this.titleErrorNode,!0,this.intlMessage({intlName:o[e].default}))):this.showError(this.createErrorNode,!0,this.createError)}.bind(this))):(this.goToStep(1),this.showError(this.titleErrorNode,!0,this.titleError))},handlePrivacyKeyPress:function(t){var e=t.keyCode,i=t.target.ancestor(".radio",!0).one(".toggle-input"),o=i.get("type");13===e&&("radio"===o?i.get("checked")||(i.set("checked",!0),this.handlePrivacyRadioChange(t)):(i.set("checked",!i.get("checked")),this.handlePrivacyRadioChange(t)))},handleAgeKeyPress:function(t){var e=t.keyCode,i=t.target.ancestor(".radio",!0).one(".toggle-input"),o=i.hasAttribute("disabled");13!==e||i.get("checked")||o||(i.set("checked",!0),this.handleAgeRadioChange(t))},handlePrivacyRadioChange:function(t){var e=t.target.ancestor(".radio",!0);e.hasClass("public-group")?(this.privateGroupOptionContainer.addClass("hidden"),this.privateGroupInput.set("checked",!1),this.groupOptions.privacy=h):e.hasClass("invite-only-group")?(this.privateGroupOptionContainer.removeClass("hidden"),this.groupOptions.privacy=a):e.hasClass("private-group")&&(e.one(".toggle-input").get("checked")?this.groupOptions.privacy=r:this.groupOptions.privacy=a),this.fire("contentSizeChanged")},handleAgeRadioChange:function(t){var e=t.target.get("id");"all-age-group"===e?this.groupOptions.ageRestriction=l:"adult-group"===e&&(this.groupOptions.ageRestriction=c,this.groupOptions.safety=s)},goToStep:function(t){var e=this.get("container"),i=e.one('.step-container[data-step-index="'+this.activeStep+'"]'),o=e.one('.step-container[data-step-index="'+t+'"]');clearTimeout(this.goToStepTimeout),o.removeClass("hiding-left"),o.removeClass("hiding-right"),i.removeClass("showing"),i.removeClass("showing-left"),i.removeClass("showing-right"),o.removeClass("hidden"),o.addClass("showing"),t>this.activeStep?(i.addClass("hiding-left"),setTimeout((function(){o.addClass("showing-left")}),0)):(i.addClass("hiding-right"),setTimeout((function(){o.addClass("showing-right")}),0)),this.goToStepTimeout=setTimeout((function(){i.removeClass("hiding-left"),i.removeClass("hiding-right"),o.removeClass("showing"),o.removeClass("showing-left"),o.removeClass("showing-right"),i.addClass("hidden")}),300),this.setStepValues(t),1===this.activeStep&&this.titleNode.focus(),this.fire("contentSizeChanged")},setStepValues:function(t){var e=this;this.headTitleNode.addClass("changing"),this.actionContainer.addClass("changing"),e.setStepValuesTimeout=setTimeout((function(){e.headTitleNode.set("innerHTML",e.labelList[t].title),e.cancelButton.set("text",e.labelList[t].cancelText),e.actionButton.set("text",e.labelList[t].actionText)}),300),this.setStepValuesTimeout=setTimeout((function(){e.headTitleNode.removeClass("changing"),e.actionContainer.removeClass("changing"),e.cancelButton.set("text",e.labelList[t].cancelText),e.actionButton.set("text",e.labelList[t].actionText)}),600),this.activeStep=t},createNewAndAddPhoto:function(){var e,i=this,o=this.titleNode.get("value"),n=this.descriptionNode.get("value");return e={name:o,description:n,userId:this.appContext.getViewer().nsid,privacyLevel:this.groupOptions.privacy,ageRestriction:this.groupOptions.ageRestriction,safetyLevel:this.groupOptions.safety},this.appContext.getModelRegistry("group-info-models").then((function(t){return i.groupInfoModelRegistry=t,t.remote.create(e,i.appContext)})).then((function(e){return i.photoId?i.addPhoto(e.id,i.photoId).then((function(){return e})):t.Promise.resolve(e)})).catch((function(t){throw t}))},addPhoto:function(t,e){var o=this;return this.appContext.getModel("group-pool-models",t).then((function(t){return o.photoModel.getValue("isOwner")?o.addToGroup(t,e):o.inviteToGroup(t,e)})).catch((function(t){i.error("Error adding photo after group creation",{err:t})}))},addToGroup:function(e,o){var n=e.getValue("id");return e.addPhotoRemote(o).catch((function(s){if(6===s.code){if(this.pendingGroupRegistry.addOrUpdate({id:[o,n].join("-"),photoId:o,groupId:n}),t.Snowplough){var r={id:n},a=[];a=a.concat(t.Snowplough.getGroupContext(r)),this.appContext.getModel("photo-models",o).then(function(e){t.Snowplough.sendStructuredEvent({category:"group",action:"invite_photo"},a.concat(t.Snowplough.getPhotoContextFromModel(e)))}.bind(this))}return e}throw i.error("Error adding photo to group",{err:s}),s}))},inviteToGroup:function(t,e){t.getValue("id");return t.invitePhotoRemote(e).catch((function(e){if(6===e.code)return t;throw i.error("Error inviting photo to group",{err:e}),e}))},showError:function(e,i,o){o&&e.set("text",t.StringHelper.preventOrphans(o)),i?e.removeClass("hidden"):e.addClass("hidden")},resetView:function(){this.buildContainer(),this.activate()}})}),"@VERSION@",{requires:["flickr-view","stuff-creation-view","hermes-template-group-creation-view","string-helper","group-guidelines"],optionalRequires:["hermes-core"],langBundles:["common","global-nav","stats","groups","add-to-stuff"]});YUI.add("curation-helper",(function(e,i){require("hermes-core/flog")(i),e.mix({langBundles:["prints"]},e.Localizable);e.CurationHelper=function(i,o){var r=this,s=o.view;return this.showAddToCuration=function(o){let t,a,n=o.photoId,l=o.customConfig,u=o.anchorNode,d=void 0===o.useViewportType||o.useViewportType,c=o.containerType,p=void 0===o.showAlbums||o.showAlbums,w=void 0!==o.showGalleries&&o.showGalleries,h=void 0===o.showGroups||o.showGroups,m=o.initialTab,v={},f=o.modalSizeConfig||void 0;return m||(m=p?"album":"gallery"),t=l||{photoId:n,initialTab:m,showAlbums:p,showGalleries:w,showGroups:h,inlineGroupCreation:!1,dismissOnSelect:!0,dismissOnCreate:!0,modalSizeConfig:f},t=Object.assign(t,{appContext:i}),v={useViewportType:d,containerType:c,configs:{droparound:{preferTop:!0,width:400,anchorElement:u,keyboardAnchorElement:u},modal:{flexLayout:!0,height:450}}},a=new e.ModalDroparoundHelper(i,v),"droparound"===a.params.containerType||(t.inlineGroupCreation=!0,t.useLargeLayout=!0,t.dismissOnSelect=!1,t.dismissOnCreate=!1),this.curateView=new e.Views["add-to-stuff-view"](t),v.configs.common.subview=this.curateView,a.setParams(v),this.curateWrapperView=a.show(),s.registerEventHandler(a.on("close",(function(e){r.fire("curateDroparoundClosed")}))),this.curateWrapperView},this.showCreationModal=function(o){var r=o.viewName,t=o.customConfig,a=o.overlayClassList,n={appContext:i};n=Object.assign(n,t),this.creationView=new e.Views[r](n),this.creationModal=new e.Views.FluidModal({appContext:i,subview:this.creationView,overlayClassList:a,dismissOnOverlayClick:!1,dismissOnEsc:!1,hasSubviewConfigRefactor:!0}),this.creationModal.show(),s.registerEventHandler(this.creationModal.on("activated",(e=>{this.creationView.focusInitial()})))},this},e.augment(e.CurationHelper,e.EventTarget)}),"@VERSION@",{requires:["event-custom","add-to-stuff-view","album-creation-view","gallery-creation-view","group-creation-view","modal-droparound-helper"],optionalRequires:["hermes-core"]});YUI.add("photo-list-photo-interaction-view",(function(e,t){var i=require("hermes-core/type-validator"),o=require("hermes-core/flog")(t),n={faveClickArea:".fave-area",commentClickArea:".comment-area",removeFaveTool:"remove-fave",removePoolTool:"remove-group-pool",removeShowCasePhoto:"remove-showcase-photo",removePhotosOfYou:"remove-photosof-you",scotchTool:"scotch-photo"};e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t=this.appContext.getViewer();return e.subviewParams={"like-engagement-item-view":{photoId:this.get("id"),showCount:!0,size:"small",isPadded:!1,theme:"light",engagementModelName:"photo-lite-models"}},""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),t.signedIn&&e.nsid===t.nsid||this.set("viewingSelf",!1),e.photoPageUrl&&this.set("photoPageUrl",e.photoPageUrl),this.params=e,this.signedIn=t.signedIn,void 0!==e.showCurate?this.showCurate=e.showCurate:this.showCurate=this.signedIn,this},subviewConfig:{"like-engagement-item-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-likes")}}},loadState:function(){var t=[],i=this.get("listModelParams");return t.push(this.appContext.getModel(this.get("engagementModelName"),this.get("id"))),i&&t.push(this.appContext.getModel(i.registryName,i.modelIdOrAttributes)),e.Promise.all(t).then(function(e){var t=e[0],i=e[1];this.set("engagement",t),this.extraFunctionality={moreMenuItems:[]},this.params.removeOwnFaves?this.get("model").getValue("isOwner")&&!this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=n.removeFaveTool):this.params.removePoolPhoto?(this.get("model").getValue("isOwner")||i&&(i.getValue("group").getValue("isAdmin")||i.getValue("group").getValue("isModerator")))&&(this.extraFunctionality.removeToolClass=n.removePoolTool):this.params.scotch?this.extraFunctionality.removeToolClass=n.scotchTool:this.params.removeShowCasePhoto?this.get("model").getValue("isOwner")&&this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=n.removeShowCasePhoto):this.params.removePhotosOfYou&&this.get("viewingSelf")&&(this.extraFunctionality.removeToolClass=n.removePhotosOfYou),this.params.excludePeople&&this.extraFunctionality.moreMenuItems.push("exclude-people"),this.params.banUser&&i&&(i.getValue("group").getValue("isAdmin")||i.getValue("group").getValue("isModerator"))&&this.extraFunctionality.moreMenuItems.push("ban-user"),this.params.removeUser&&i&&(i.getValue("group").getValue("isAdmin")||i.getValue("group").getValue("isModerator"))&&this.extraFunctionality.moreMenuItems.push("remove-user"),this.params.bigScotch&&(this.extraFunctionality.bigScotchTitle=this.godMessage({intlName:"explore.DO_BIG_SCOTCH"})),this.extraFunctionality.moreMenuItems=this.extraFunctionality.moreMenuItems.join(",")}.bind(this))},buildContainer:function(t){var i=this.get("engagement"),o=i.getValue("faveCount"),n=i.getValue("isFaved"),a=i.getValue("canFave"),s=i.getValue("commentCount");return t=t||{},o=e.IntlNumber.format(o,this.appContext.lang,1),s=e.IntlNumber.format(s,this.appContext.lang,1),t.photo=this.get("model").toJSON(),t.photoPageUrl=this.get("photoPageUrl"),t.faveCount=o,t.isFaved=n,t.canFave=a,t.commentCount=s,t.displayCurate=this.showCurate,t.hasExtraFunctionality=Object.keys(this.extraFunctionality).length>0,t.removeToolClass=this.extraFunctionality.removeToolClass,t.moreMenuItems=this.extraFunctionality.moreMenuItems,t.bigScotchTitle=this.extraFunctionality.bigScotchTitle,this.setContainerWithTemplate("photo-list-photo-interaction",t),this},activate:function(){var t=this,i=(this.appContext.getViewer(),this.get("engagement")),o=this.get("container");return this.infoBar=o.one(".interaction-bar"),this.detailsNode=this.infoBar.one(".text"),this.infoBarEngagement=this.infoBar.one(".engagement"),this.faveNode=this.infoBarEngagement.one(".engagement-item.fave"),this.commentNode=this.infoBarEngagement.one(".engagement-item.comment"),this.appContext.flipper.isFlipped("enable-likes")&&(this.likeNode=this.infoBarEngagement.one(".engagement-item.like"),this.likeView=this.subviews["like-engagement-item-view"],this.likeView.isActivated?(this.isActive=!0,this.fire("activated")):this.likeView.on("activated",(function(){t.isActive=!0,t.fire("activated")}))),this.curateNode=this.infoBar.one(".engagement-item.curate"),this.curateNode&&this.registerEventHandler(this.curateNode.on(["click","keydown"],this.handleCurateClick.bind(this))),this.faveNode&&(this.faveCountNode=this.faveNode.one(".engagement-count"),this.registerEventHandler(this.faveNode.on(["click","keydown"],this.handleFaveClick.bind(this)))),this.commentNode&&(this.commentIconNode=this.commentNode.one(".engagement-icon"),this.commentTextNode=this.commentNode.one(".engagement-count"),this.registerEventHandler(this.commentNode.on(["click","keydown"],this.handleCommentClick.bind(this)))),this.registerEventHandler(i.on("valuesChanged",this.handleEngagementModelValuesChanged.bind(this))),this.registerEventHandler(e.on("resize",e.betterThrottle(this.updateBreakpoints.bind(this),500,this,!0))),this.appContext.flipper.isFlipped("enable-likes")||(t.isActive=!0,t.fire("activated")),this},handleFaveClick:function(e){var t,i,n,a,s;if("click"===e.type||13===e.keyCode||32===e.keyCode){if(t=this,i=e.currentTarget,n=i.one(".engagement-count"),s=this.appContext.getViewer(),e.halt(),this.faveNode.hasClass("can-not-fave"))return;if(!this.signedIn)return void this.showSignUpAndFaveModal();this.isFaving||(this.isFaving=!0,this.get("engagement").toggleFave(),a=this.get("engagement").getValue("faveCount"),i.toggleClass("faved",this.get("engagement").getValue("isFaved")),n.toggleClass("empty",0===a),n&&a>0?n.set("text",a):n.set("text",""),this.get("engagement").remoteUpdate().then(function(){this.appContext.getModelRegistry("favorite-models").then((function(e){e.proxy(s.nsid).getValue("photoPageList").remove(t.get("model"))})),this.isFaving=!1}.bind(this),function(e){3!==e.code&&(this.get("engagement").toggleFave(),i.toggleClass("faved",this.get("engagement").getValue("isFaved")),n&&(n.set("text",a),n.toggleClass("empty",0===a))),o.error("Error faving photo",{err:e}),this.isFaving=!1}.bind(this)))}},handleCommentClick:function(t){var i,o=this;if("click"===t.type||13===t.keyCode||32===t.keyCode){t.halt();let n={appContext:this.appContext,photoId:this.get("model").getValue("id"),isScrollable:!0};(i=new e.ModalDroparoundHelper(this.appContext,{configs:{common:{subviewName:"photo-comments-view"},droparound:{preferTop:!0,width:400,height:400,anchorElement:this.commentIconNode,keyboardAnchorElement:this.commentIconNode,subviewParams:n},modal:{height:550,flexLayout:!0,subviewParams:Object.assign({},n,{hasHeader:!0})}}})).show(),o.registerEventHandler(e.on("addComment:showingSignupModal",(function(){i.close()}))),i.on("close",(function(){o.commentNode.removeClass("active"),o.fire("hoverActionClosed")})),this.commentNode.addClass("active"),this.fire("hoverActionOpened")}},showSignUpAndFaveModal:function(){var t,i=this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),o=this.intlMessage({intlName:"fave-view.JOIN_FLICKR_AND_FAVE"}),n=this.get("engagement"),a=n.getValue("id"),s=e.url(e.URLHelper.getPhotoPage({photoId:a,pathAlias:n.getValue("ownerNsid")}));(t=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-fave",signUpTitle:i,signUpMessage:o,beaconPrefix:"fave"})).on("signUpClick",(function(t){e.SigninHelper.signUpPendingFave({id:a},{postLoginUrl:s})})),t.on("signInClick",(function(t){e.SigninHelper.addPendingFave({id:a},{postLoginUrl:s})})),t.show()},showSignUpAndCommentModal:function(){var t,i,o=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_COMMENT_TITLE"}),n=this.intlMessage({intlName:"photo-page-scrappy.SIGNUP_AND_COMMENT_MESSAGE"}),a=this.get("engagement");e.rapidTracker.beacon(this.name,"commentIconClick"),i=e.url(e.URLHelper.getPhotoPage({photoId:a.getValue("id"),pathAlias:a.getValue("ownerNsid")})),(t=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-comment",signUpTitle:o,signUpMessage:n,beaconPrefix:"comment"})).on("signUpClick",(function(t){e.SigninHelper._redirectToSignUp("comment",{postLoginUrl:i})})),t.on("signInClick",(function(t){e.SigninHelper._redirectToSignin("comment",{postLoginUrl:i})})),t.show()},handleEngagementModelValuesChanged:function(t){var i;t.commentCount&&(i=t.commentCount.newVal,this.commentTextNode.set("text",e.IntlNumber.format(i,this.appContext.lang,1)),this.commentTextNode.toggleClass("hidden",0===i),this.updateBreakpoints()),void 0===t.faveCount&&void 0===t.isFaved&&void 0===t.canFave||this.updateBreakpoints()},handleCurateClick:function(e){"click"!==e.type&&13!==e.keyCode&&32!==e.keyCode||(e.halt(),this.showAddToCuration())},showAddToCuration:function(){var t=this,i=this.get("model").getValue("isOwner"),o=new e.CurationHelper(this.appContext,{view:this});"fluid-droparound-view"===o.showAddToCuration({photoId:this.get("model").getValue("id"),showAlbums:i,showGalleries:!i,anchorNode:this.curateNode}).name&&(t.fire("hoverActionOpened"),o.on("curateDroparoundClosed",(function(){t.fire("hoverActionClosed")})))},updateBreakpoints:function(){var e,t=0;this.isActive&&(0===(e=this.infoBar.get("clientWidth"))||e>160||(this.infoBar.addClass("invisible"),this.infoBar.removeClass("narrow"),this.detailsNode.removeClass("hidden"),this.commentNode.removeClass("hidden"),this.curateNode&&this.curateNode.removeClass("hidden"),this.appContext.flipper.isFlipped("enable-likes")?this.likeNode&&(this.likeNode.removeClass("hidden"),this.likeNode.removeClass("last"),this.likeView.showCountNode(!0)):this.faveNode&&(this.faveNode.removeClass("hidden"),this.faveNode.removeClass("last"),this.faveCountNode.removeClass("hidden")),this.detailsNode.get("clientWidth")<=10&&(this.infoBar.addClass("narrow"),this.detailsNode.addClass("hidden")),this.infoBar.get("clientWidth")<this.infoBarEngagement.get("clientWidth")+24&&(this.commentNode.addClass("hidden"),this.appContext.flipper.isFlipped("enable-likes")?(this.curateNode?t=this.curateNode.get("clientWidth"):this.likeNode.addClass("last"),this.infoBar.get("clientWidth")<t+this.likeNode.get("clientWidth")+24&&this.likeView.showCountNode(!1),this.curateNode&&this.infoBar.get("clientWidth")<this.infoBarEngagement.get("clientWidth")+24&&(this.curateNode.addClass("hidden"),this.likeNode.addClass("last"))):(this.curateNode?t=this.curateNode.get("clientWidth"):this.faveNode.addClass("last"),this.faveCountNode&&this.infoBar.get("clientWidth")<t+this.faveNode.get("clientWidth")+24&&this.faveCountNode.addClass("hidden"),this.curateNode&&this.infoBar.get("clientWidth")<this.infoBarEngagement.get("clientWidth")+24&&(this.curateNode.addClass("hidden"),this.faveNode.addClass("last")))),this.infoBar.removeClass("invisible")))},destructor:function(){}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,t){return i.photoId(e)}},model:{writeOnce:"initOnly"},listModelParams:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"},engagement:{value:null},viewingSelf:{value:!0},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,i){return e.AttributeHelpers.validateString(t)}},layoutWidth:{validator:function(t,i){return e.AttributeHelpers.validateFloat(t)},setter:function(t){return e.AttributeHelpers.coerceFloat(t)||void 0},defaultFn:function(e){return 0}},isFaving:{value:!1,validator:function(t,i){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}}}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-photo-interaction","attribute-helpers","fluid-modal-view","fluid-droparound-view","add-to-stuff-view","photo-comments-view","like-engagement-item-view","url","intl-number","curation-helper"],optionalRequires:["fluid","hermes-core"],langBundles:["fave-view","common","photo-page-scrappy","comments"]});YUI.add("hermes-lang-fave-view",(function(e,t){e.Intl.add("hermes/fave-view","en-US",{COULDNT_FAVE:[{type:0,value:"We couldn’t fave at this time"}],SIGN_IN_TO_FAVE:[{type:0,value:"You must be signed in to fave. Please sign in now."}],LOADING_FAVES:[{type:0,value:"Loading Faves..."}],UNFAVE_PHOTO:[{type:0,value:"Unfave this photo"}],FAVE_PHOTO:[{type:0,value:"Fave this photo"}],WHO_FAVED:[{type:0,value:"Who faved this photo"}],SIGN_IN_BEFORE_FAVE_TITLE:[{type:0,value:"You found a photo to fave!"}],SIGN_IN_BEFORE_FAVE_MESSAGE:[{type:0,value:"That’s great. Just sign in to fave it."}],SIGN_IN_AND_FAVE:[{type:0,value:"Sign in and fave"}],JOIN_FLICKR_AND_FAVE:[{type:0,value:"Join Flickr to add this photo to your favorites."}]})}),"@VERSION@",{requires:["intl"]});